{"version":3,"file":"ClipImage.js","sources":["../src/utils.js","../src/index.js"],"sourcesContent":["export default {\n    readFileSize: function (file) {\n        return (file.size / 1024).toFixed(4) > 1024 ?  (file.size / 1024 * 1024).toFixed(4)+ ' MB' : (file.size / 1024).toFixed(4)+ ' KB'\n    },\n    isImageDom: function (img) {\n        return img.tagName.toLowerCase() === 'img';\n    },\n    isCanvasDom: function (canvas) {\n        return canvas.tagName.toLowerCase() === 'canvas';\n    },\n    isVideoDom: function (video) {\n        return video.tagName.toLowerCase() === 'video';\n    },\n\n    isPX: function (str) {\n        return str.trim().endsWith('px');\n    },\n    isPercent: function (str) {\n        return str.trim().endsWith('%');\n    },\n    isCenter: function (str) {\n        return str.trim().toLowerCase() === 'center';\n    },\n    isLeft: function (str) {\n        return str.trim().toLowerCase() === 'left';\n    },\n    isTop: function (str) {\n        return str.trim().toLowerCase() === 'top';\n    },\n    isRight: function (str) {\n        return str.trim().toLowerCase() === 'right';\n    },\n    isBottom: function (str) {\n        return str.trim().toLowerCase() === 'bottom';\n    },\n\n    isPNG(val){\n        return val.trim().toLowerCase() === 'png';\n    },\n    isJPG(val){\n        return val.trim().toLowerCase() === 'jpg' || val.trim().toLowerCase() === 'jpeg';\n    },\n    //数组判断\n    isArray: Array.isArray || function (arr) {\n        return Array.prototype.toString.call(arr) === '[object Array]';\n    },\n    //判断数字\n    isNumber: function (val) {\n        //isFinite 检测是否为无穷大\n        //isNumber(parseInt(a))   // true\n        // 第一种写法\n        return typeof val === 'number' && isFinite(val);\n        //第二种写法\n        // return typeof val === 'number' && !isNaN(val)\n    },\n    //判断字符串\n    isString: function (str) {\n        return typeof str === 'string';\n    },\n    //判断布尔值\n    isBoolean: function (bool) {\n        return typeof bool === 'boolean';\n    },\n    //判断函数\n    isFun: function (fn) {\n        return typeof fn === 'function';\n    },\n    //判断对象\n    isObject: function (obj) {\n        //{},[],null 用typeof检测不出来\n        return Object.prototype.toString.call(obj) === '[object Object]';\n    },\n    //判断undefined\n    isUndefined: function (undefined) {\n        return typeof undefined === 'undefined';\n    },\n    isNull: function (n) {\n        //判断空值用 n === null\n        return n === null;\n    },\n    isNaN: function (val) {\n        return typeof val === 'number' && isNaN(val);\n    },\n    $(ele){\n        if(document.querySelector){\n            return document.querySelector(ele);\n        } else {\n            if (ele.indexOf('#') > -1){\n                return document.getElementById(ele.replace('#',''));\n            } else if (ele.indexOf('.') > -1){\n                return document.getElementsByClassName(ele.replace('.',''))[0];\n            } else {\n                return document.getElementsByTagName(ele)[0];\n            }\n        }\n    },\n    extend(){\n        let options, name, clone, copy, source, copyIsArray,\n            target = arguments[0] || {},\n            i = 1,\n            length = arguments.length,\n            deep = false;\n\n        if (typeof target === 'boolean') {\n            deep = target;\n            target = arguments[i] || {};\n            i++;\n        }\n\n        if (typeof target !== 'object' && type(target) !== 'function') {\n            target = {};\n        }\n\n        if (i === length) {\n            target = this;\n            i--;\n        }\n\n        for (; i < length; i++) {\n            //\n            if ((options = arguments[i]) !== null) {\n                // for in source object\n                for (name in options) {\n\n                    source = target[name];\n                    copy = options[name];\n\n                    if (target == copy) {\n                        continue;\n                    }\n\n                    // deep clone\n                    if (deep && copy && (isPlainObject(copy) || (copyIsArray = Array.isArray(copy)))) {\n                        // if copy is array\n                        if (copyIsArray) {\n                            copyIsArray = false;\n                            // if is not array, set it to array\n                            clone = source && Array.isArray(source) ? source : [];\n                        } else {\n                            // if copy is not a object, set it to object\n                            clone = source && isPlainObject(source) ? source : {};\n                        }\n\n                        target[name] = this.extend(deep, clone, copy);\n                    } else if (copy !== undefined) {\n                        target[name] = copy;\n                    }\n                }\n            }\n        }\n\n        return target;\n    },\n};\n\nfunction type(object) {\n    let class2type = {},\n        type = class2type.toString.call(object),\n        typeString = 'Boolean Number String Function Array Date RegExp Object Error Symbol';\n\n    if (object == null) {\n        return object + '';\n    }\n\n    typeString.split(' ').forEach((type) => {\n        class2type[`[object ${type}]`] = type.toLowerCase();\n    });\n\n    return (\n        typeof object === 'object' ||\n        typeof object === 'function' ?\n            class2type[type] || 'object' :\n            typeof object\n    );\n}\n\nfunction isPlainObject(object) {\n    let proto,\n        ctor,\n        class2type = {},\n        toString = class2type.toString,\n        hasOwn = class2type.hasOwnProperty,\n        fnToString = hasOwn.toString,\n        ObjectFunctionString = fnToString.call(Object);\n\n    if (!object || toString.call(object) !== '[object Object]') return false;\n\n    proto = Object.getPrototypeOf(object);\n\n    if (!proto) return true;\n\n    ctor = hasOwn.call(proto, 'constructor') && proto.constructor;\n\n    return typeof ctor === 'function' && fnToString.call(ctor) === ObjectFunctionString;\n}","import utils from './utils';\n\nfunction ClipImage(...options) {\n    console.log('ImageClip');\n    return new Promise((resolve, reject) => {\n        this.init(options,resolve,reject);\n    });\n}\n\nClipImage.prototype = {\n    init(options,resolve,reject){\n        console.log('options', options);\n        this.defaultConfigOption = {\n            width: 100,\n            height: 100,\n            left: 0, //数字 px, %, center top 等等\n            top: 0,\n            type: 'jpeg',\n            quality: 1, //0-1\n            success(){},\n            error(){},\n        };\n        this.errorObj = {};\n\n        if (utils.isUndefined(options[0]) || (!utils.isString(options[0]) && !utils.isImageDom(options[0]) && !utils.isCanvasDom(options[0]) && !utils.isVideoDom(options[0]))) return new Error('ClipImage第一个参数是url/HTMLImageElement/HTMLVideoElement/HTMLCanvasElement');\n        if (!utils.isObject(options[1])) return new Error('ClipImage第二个参数是对象哦~~');\n\n        this.canvasImageSource = options[0];\n        this.configOptions = utils.extend(true, this.defaultConfigOption, options[1]);\n\n        this.initCanvas(this.canvasImageSource,resolve,reject);\n    },\n    initCanvas(source,resolve,reject){\n        this.resultCanvas = document.createElement('canvas');\n        this.resultCtx = this.resultCanvas.getContext('2d');\n\n        this.resultW = this.getRealVal(this.configOptions.width, 'x');\n        this.resultH = this.getRealVal(this.configOptions.height, 'y');\n        this.sourceX = this.getRealVal(this.configOptions.left, 'x');\n        this.sourceY = this.getRealVal(this.configOptions.top, 'y');\n\n        this.resultCanvas.width = this.resultW;\n        this.resultCanvas.height = this.resultH;\n\n        if (utils.isString(source) || utils.isImageDom(source)){\n            this.sourceImage = new Image();\n            this.sourceImage.setAttribute('crossOrigin', 'anonymous');\n            this.sourceImage.onload = () => {\n                this.clip(resolve);\n            };\n            this.sourceImage.onerror = (error) =>{\n                this.configOptions.error && this.configOptions.error(error);\n                reject(error);\n            };\n            this.sourceImage.src = utils.isImageDom(source) ? source.src : source;\n        }\n        else if (utils.isCanvasDom(source) || utils.isVideoDom(source)){\n            this.sourceImage = source;\n            this.clip(resolve);\n        }\n        else {\n            reject()\n        }\n    },\n    clip(resolve){\n        console.log('source',this.sourceImage);\n\n        this.resultCtx.drawImage(this.sourceImage, this.sourceX, this.sourceY, this.resultW, this.resultH, 0, 0, this.resultW, this.resultH);\n\n        this.resultB64 = this.resultCanvas.toDataURL(`image/${this.getOutType(this.configOptions.type)}`, this.configOptions.quality);\n\n        this.configOptions.success && this.configOptions.success(this.resultB64);\n\n        // this.resultCanvas.toBlob((result) => {\n        //     console.log('toBlob result', result)\n        //\n        //     this.resultObj.b64 = this.resultB64\n        //     this.resultObj.size = 'Size: ' + utils.readFileSize(result)\n        //     this.resultObj.type = 'Type: ' + result.type\n        //     this.resultObj.width = this.op\n        // }, `image/${this.getOutType(this.configOptions.type)}`)\n        resolve(this.resultB64);\n    },\n\n    getRealVal(val, direction){\n        if (utils.isNumber(val) || (utils.isString(val) && utils.isPX(val))){\n            return utils.isNumber(val) ? val : parseInt(val.trim().slice(0, -2));\n        }\n        else if (utils.isString(val) && utils.isPercent(val)){\n            return direction === 'x' ? this.sourceImage.width * (parseInt(val.slice(0, -1)) / 100 ) : this.sourceImage.height * (parseInt(val.slice(0, -1)) / 100 );\n        }\n        else if (utils.isString(val) && utils.isCenter(val)){\n            return direction === 'x' ? this.sourceImage.width / 2 : this.sourceImage.height / 2;\n        }\n        else if (utils.isString(val) && (utils.isLeft(val) || utils.isTop(val))){\n            return 0;\n        }\n        else if (utils.isString(val) && (utils.isRight(val) || utils.isBottom(val))){\n            return utils.isRight(val) ? this.sourceImage.width : this.sourceImage.height;\n        }\n        else {\n            this.errorObj.msg = '参数配置错误';\n            this.configOptions.error && this.configOptions.error(this.errorObj);\n            return false;\n        }\n    },\n    getOutType(val){\n        return utils.isJPG(val) ? 'jpeg' : 'png';\n    },\n};\n\nexport default ClipImage;\n"],"names":["file","size","toFixed","img","tagName","toLowerCase","canvas","video","str","trim","endsWith","val","Array","isArray","arr","prototype","toString","call","isFinite","bool","fn","obj","Object","undefined","n","isNaN","ele","document","querySelector","indexOf","getElementById","replace","getElementsByClassName","getElementsByTagName","options","name","clone","copy","source","copyIsArray","target","arguments","i","length","deep","type","isPlainObject","extend","object","class2type","typeString","split","forEach","proto","ctor","hasOwn","hasOwnProperty","fnToString","ObjectFunctionString","getPrototypeOf","constructor","ClipImage","log","Promise","resolve","reject","init","defaultConfigOption","errorObj","utils","isUndefined","isString","isImageDom","isCanvasDom","isVideoDom","Error","isObject","canvasImageSource","configOptions","initCanvas","resultCanvas","createElement","resultCtx","getContext","resultW","getRealVal","width","resultH","height","sourceX","left","sourceY","top","sourceImage","Image","setAttribute","onload","clip","onerror","error","src","drawImage","resultB64","toDataURL","getOutType","quality","success","direction","isNumber","isPX","parseInt","slice","isPercent","isCenter","isLeft","isTop","isRight","isBottom","msg","isJPG"],"mappings":";;;;;;AAAA,YAAe;kBACG,UAAUA,IAAV,EAAgB;eACnB,CAACA,KAAKC,IAAL,GAAY,IAAb,EAAmBC,OAAnB,CAA2B,CAA3B,IAAgC,IAAhC,GAAwC,CAACF,KAAKC,IAAL,GAAY,IAAZ,GAAmB,IAApB,EAA0BC,OAA1B,CAAkC,CAAlC,IAAsC,KAA9E,GAAsF,CAACF,KAAKC,IAAL,GAAY,IAAb,EAAmBC,OAAnB,CAA2B,CAA3B,IAA+B,KAA5H;KAFO;gBAIC,UAAUC,GAAV,EAAe;eAChBA,IAAIC,OAAJ,CAAYC,WAAZ,OAA8B,KAArC;KALO;iBAOE,UAAUC,MAAV,EAAkB;eACpBA,OAAOF,OAAP,CAAeC,WAAf,OAAiC,QAAxC;KARO;gBAUC,UAAUE,KAAV,EAAiB;eAClBA,MAAMH,OAAN,CAAcC,WAAd,OAAgC,OAAvC;KAXO;;UAcL,UAAUG,GAAV,EAAe;eACVA,IAAIC,IAAJ,GAAWC,QAAX,CAAoB,IAApB,CAAP;KAfO;eAiBA,UAAUF,GAAV,EAAe;eACfA,IAAIC,IAAJ,GAAWC,QAAX,CAAoB,GAApB,CAAP;KAlBO;cAoBD,UAAUF,GAAV,EAAe;eACdA,IAAIC,IAAJ,GAAWJ,WAAX,OAA6B,QAApC;KArBO;YAuBH,UAAUG,GAAV,EAAe;eACZA,IAAIC,IAAJ,GAAWJ,WAAX,OAA6B,MAApC;KAxBO;WA0BJ,UAAUG,GAAV,EAAe;eACXA,IAAIC,IAAJ,GAAWJ,WAAX,OAA6B,KAApC;KA3BO;aA6BF,UAAUG,GAAV,EAAe;eACbA,IAAIC,IAAJ,GAAWJ,WAAX,OAA6B,OAApC;KA9BO;cAgCD,UAAUG,GAAV,EAAe;eACdA,IAAIC,IAAJ,GAAWJ,WAAX,OAA6B,QAApC;KAjCO;;UAoCLM,GAAN,EAAU;eACCA,IAAIF,IAAJ,GAAWJ,WAAX,OAA6B,KAApC;KArCO;UAuCLM,GAAN,EAAU;eACCA,IAAIF,IAAJ,GAAWJ,WAAX,OAA6B,KAA7B,IAAsCM,IAAIF,IAAJ,GAAWJ,WAAX,OAA6B,MAA1E;KAxCO;;aA2CFO,MAAMC,OAAN,IAAiB,UAAUC,GAAV,EAAe;eAC9BF,MAAMG,SAAN,CAAgBC,QAAhB,CAAyBC,IAAzB,CAA8BH,GAA9B,MAAuC,gBAA9C;KA5CO;;cA+CD,UAAUH,GAAV,EAAe;;;;eAId,OAAOA,GAAP,KAAe,QAAf,IAA2BO,SAASP,GAAT,CAAlC;;;KAnDO;;cAwDD,UAAUH,GAAV,EAAe;eACd,OAAOA,GAAP,KAAe,QAAtB;KAzDO;;eA4DA,UAAUW,IAAV,EAAgB;eAChB,OAAOA,IAAP,KAAgB,SAAvB;KA7DO;;WAgEJ,UAAUC,EAAV,EAAc;eACV,OAAOA,EAAP,KAAc,UAArB;KAjEO;;cAoED,UAAUC,GAAV,EAAe;;eAEdC,OAAOP,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BI,GAA/B,MAAwC,iBAA/C;KAtEO;;iBAyEE,UAAUE,SAAV,EAAqB;eACvB,OAAOA,SAAP,KAAqB,WAA5B;KA1EO;YA4EH,UAAUC,CAAV,EAAa;;eAEVA,MAAM,IAAb;KA9EO;WAgFJ,UAAUb,GAAV,EAAe;eACX,OAAOA,GAAP,KAAe,QAAf,IAA2Bc,MAAMd,GAAN,CAAlC;KAjFO;MAmFTe,GAAF,EAAM;YACCC,SAASC,aAAZ,EAA0B;mBACfD,SAASC,aAAT,CAAuBF,GAAvB,CAAP;SADJ,MAEO;gBACCA,IAAIG,OAAJ,CAAY,GAAZ,IAAmB,CAAC,CAAxB,EAA0B;uBACfF,SAASG,cAAT,CAAwBJ,IAAIK,OAAJ,CAAY,GAAZ,EAAgB,EAAhB,CAAxB,CAAP;aADJ,MAEO,IAAIL,IAAIG,OAAJ,CAAY,GAAZ,IAAmB,CAAC,CAAxB,EAA0B;uBACtBF,SAASK,sBAAT,CAAgCN,IAAIK,OAAJ,CAAY,GAAZ,EAAgB,EAAhB,CAAhC,EAAqD,CAArD,CAAP;aADG,MAEA;uBACIJ,SAASM,oBAAT,CAA8BP,GAA9B,EAAmC,CAAnC,CAAP;;;KA5FD;aAgGH;YACAQ,OAAJ;YAAaC,IAAb;YAAmBC,KAAnB;YAA0BC,IAA1B;YAAgCC,MAAhC;YAAwCC,WAAxC;YACIC,SAASC,UAAU,CAAV,KAAgB,EAD7B;YAEIC,IAAI,CAFR;YAGIC,SAASF,UAAUE,MAHvB;YAIIC,OAAO,KAJX;;YAMI,OAAOJ,MAAP,KAAkB,SAAtB,EAAiC;mBACtBA,MAAP;qBACSC,UAAUC,CAAV,KAAgB,EAAzB;;;;YAIA,OAAOF,MAAP,KAAkB,QAAlB,IAA8BK,KAAKL,MAAL,MAAiB,UAAnD,EAA+D;qBAClD,EAAT;;;YAGAE,MAAMC,MAAV,EAAkB;qBACL,IAAT;;;;eAIGD,IAAIC,MAAX,EAAmBD,GAAnB,EAAwB;;gBAEhB,CAACR,UAAUO,UAAUC,CAAV,CAAX,MAA6B,IAAjC,EAAuC;;qBAE9BP,IAAL,IAAaD,OAAb,EAAsB;;6BAETM,OAAOL,IAAP,CAAT;2BACOD,QAAQC,IAAR,CAAP;;wBAEIK,UAAUH,IAAd,EAAoB;;;;;wBAKhBO,QAAQP,IAAR,KAAiBS,cAAcT,IAAd,MAAwBE,cAAc3B,MAAMC,OAAN,CAAcwB,IAAd,CAAtC,CAAjB,CAAJ,EAAkF;;4BAE1EE,WAAJ,EAAiB;0CACC,KAAd;;oCAEQD,UAAU1B,MAAMC,OAAN,CAAcyB,MAAd,CAAV,GAAkCA,MAAlC,GAA2C,EAAnD;yBAHJ,MAIO;;oCAEKA,UAAUQ,cAAcR,MAAd,CAAV,GAAkCA,MAAlC,GAA2C,EAAnD;;;+BAGGH,IAAP,IAAe,KAAKY,MAAL,CAAYH,IAAZ,EAAkBR,KAAlB,EAAyBC,IAAzB,CAAf;qBAXJ,MAYO,IAAIA,SAASd,SAAb,EAAwB;+BACpBY,IAAP,IAAeE,IAAf;;;;;;eAMTG,MAAP;;CAvJR;;AA2JA,SAASK,IAAT,CAAcG,MAAd,EAAsB;QACdC,aAAa,EAAjB;QACIJ,OAAOI,WAAWjC,QAAX,CAAoBC,IAApB,CAAyB+B,MAAzB,CADX;QAEIE,aAAa,sEAFjB;;QAIIF,UAAU,IAAd,EAAoB;eACTA,SAAS,EAAhB;;;eAGOG,KAAX,CAAiB,GAAjB,EAAsBC,OAAtB,CAA+BP,IAAD,IAAU;mBACxB,WAAUA,IAAK,GAA3B,IAAiCA,KAAKxC,WAAL,EAAjC;KADJ;;WAKI,OAAO2C,MAAP,KAAkB,QAAlB,IACA,OAAOA,MAAP,KAAkB,UADlB,GAEIC,WAAWJ,IAAX,KAAoB,QAFxB,GAGI,OAAOG,MAJf;;;AAQJ,SAASF,aAAT,CAAuBE,MAAvB,EAA+B;QACvBK,KAAJ;QACIC,IADJ;QAEIL,aAAa,EAFjB;QAGIjC,WAAWiC,WAAWjC,QAH1B;QAIIuC,SAASN,WAAWO,cAJxB;QAKIC,aAAaF,OAAOvC,QALxB;QAMI0C,uBAAuBD,WAAWxC,IAAX,CAAgBK,MAAhB,CAN3B;;QAQI,CAAC0B,MAAD,IAAWhC,SAASC,IAAT,CAAc+B,MAAd,MAA0B,iBAAzC,EAA4D,OAAO,KAAP;;YAEpD1B,OAAOqC,cAAP,CAAsBX,MAAtB,CAAR;;QAEI,CAACK,KAAL,EAAY,OAAO,IAAP;;WAELE,OAAOtC,IAAP,CAAYoC,KAAZ,EAAmB,aAAnB,KAAqCA,MAAMO,WAAlD;;WAEO,OAAON,IAAP,KAAgB,UAAhB,IAA8BG,WAAWxC,IAAX,CAAgBqC,IAAhB,MAA0BI,oBAA/D;;;AC/LJ,SAASG,SAAT,CAAmB,GAAG3B,OAAtB,EAA+B;YACnB4B,GAAR,CAAY,WAAZ;WACO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;aAC/BC,IAAL,CAAUhC,OAAV,EAAkB8B,OAAlB,EAA0BC,MAA1B;KADG,CAAP;;;AAKJJ,UAAU9C,SAAV,GAAsB;SACbmB,OAAL,EAAa8B,OAAb,EAAqBC,MAArB,EAA4B;gBAChBH,GAAR,CAAY,SAAZ,EAAuB5B,OAAvB;aACKiC,mBAAL,GAA2B;mBAChB,GADgB;oBAEf,GAFe;kBAGjB,CAHiB;iBAIlB,CAJkB;kBAKjB,MALiB;qBAMd,CANc;sBAOd,EAPc;oBAQhB;SARX;aAUKC,QAAL,GAAgB,EAAhB;;YAEIC,MAAMC,WAAN,CAAkBpC,QAAQ,CAAR,CAAlB,KAAkC,CAACmC,MAAME,QAAN,CAAerC,QAAQ,CAAR,CAAf,CAAD,IAA+B,CAACmC,MAAMG,UAAN,CAAiBtC,QAAQ,CAAR,CAAjB,CAAhC,IAAgE,CAACmC,MAAMI,WAAN,CAAkBvC,QAAQ,CAAR,CAAlB,CAAjE,IAAkG,CAACmC,MAAMK,UAAN,CAAiBxC,QAAQ,CAAR,CAAjB,CAAzI,EAAwK,OAAO,IAAIyC,KAAJ,CAAU,wEAAV,CAAP;YACpK,CAACN,MAAMO,QAAN,CAAe1C,QAAQ,CAAR,CAAf,CAAL,EAAiC,OAAO,IAAIyC,KAAJ,CAAU,sBAAV,CAAP;;aAE5BE,iBAAL,GAAyB3C,QAAQ,CAAR,CAAzB;aACK4C,aAAL,GAAqBT,MAAMtB,MAAN,CAAa,IAAb,EAAmB,KAAKoB,mBAAxB,EAA6CjC,QAAQ,CAAR,CAA7C,CAArB;;aAEK6C,UAAL,CAAgB,KAAKF,iBAArB,EAAuCb,OAAvC,EAA+CC,MAA/C;KArBc;eAuBP3B,MAAX,EAAkB0B,OAAlB,EAA0BC,MAA1B,EAAiC;aACxBe,YAAL,GAAoBrD,SAASsD,aAAT,CAAuB,QAAvB,CAApB;aACKC,SAAL,GAAiB,KAAKF,YAAL,CAAkBG,UAAlB,CAA6B,IAA7B,CAAjB;;aAEKC,OAAL,GAAe,KAAKC,UAAL,CAAgB,KAAKP,aAAL,CAAmBQ,KAAnC,EAA0C,GAA1C,CAAf;aACKC,OAAL,GAAe,KAAKF,UAAL,CAAgB,KAAKP,aAAL,CAAmBU,MAAnC,EAA2C,GAA3C,CAAf;aACKC,OAAL,GAAe,KAAKJ,UAAL,CAAgB,KAAKP,aAAL,CAAmBY,IAAnC,EAAyC,GAAzC,CAAf;aACKC,OAAL,GAAe,KAAKN,UAAL,CAAgB,KAAKP,aAAL,CAAmBc,GAAnC,EAAwC,GAAxC,CAAf;;aAEKZ,YAAL,CAAkBM,KAAlB,GAA0B,KAAKF,OAA/B;aACKJ,YAAL,CAAkBQ,MAAlB,GAA2B,KAAKD,OAAhC;;YAEIlB,MAAME,QAAN,CAAejC,MAAf,KAA0B+B,MAAMG,UAAN,CAAiBlC,MAAjB,CAA9B,EAAuD;iBAC9CuD,WAAL,GAAmB,IAAIC,KAAJ,EAAnB;iBACKD,WAAL,CAAiBE,YAAjB,CAA8B,aAA9B,EAA6C,WAA7C;iBACKF,WAAL,CAAiBG,MAAjB,GAA0B,MAAM;qBACvBC,IAAL,CAAUjC,OAAV;aADJ;iBAGK6B,WAAL,CAAiBK,OAAjB,GAA4BC,KAAD,IAAU;qBAC5BrB,aAAL,CAAmBqB,KAAnB,IAA4B,KAAKrB,aAAL,CAAmBqB,KAAnB,CAAyBA,KAAzB,CAA5B;uBACOA,KAAP;aAFJ;iBAIKN,WAAL,CAAiBO,GAAjB,GAAuB/B,MAAMG,UAAN,CAAiBlC,MAAjB,IAA2BA,OAAO8D,GAAlC,GAAwC9D,MAA/D;SAVJ,MAYK,IAAI+B,MAAMI,WAAN,CAAkBnC,MAAlB,KAA6B+B,MAAMK,UAAN,CAAiBpC,MAAjB,CAAjC,EAA0D;iBACtDuD,WAAL,GAAmBvD,MAAnB;iBACK2D,IAAL,CAAUjC,OAAV;SAFC,MAIA;;;KAnDS;SAuDbA,OAAL,EAAa;gBACDF,GAAR,CAAY,QAAZ,EAAqB,KAAK+B,WAA1B;;aAEKX,SAAL,CAAemB,SAAf,CAAyB,KAAKR,WAA9B,EAA2C,KAAKJ,OAAhD,EAAyD,KAAKE,OAA9D,EAAuE,KAAKP,OAA5E,EAAqF,KAAKG,OAA1F,EAAmG,CAAnG,EAAsG,CAAtG,EAAyG,KAAKH,OAA9G,EAAuH,KAAKG,OAA5H;;aAEKe,SAAL,GAAiB,KAAKtB,YAAL,CAAkBuB,SAAlB,CAA6B,SAAQ,KAAKC,UAAL,CAAgB,KAAK1B,aAAL,CAAmBjC,IAAnC,CAAyC,EAA9E,EAAiF,KAAKiC,aAAL,CAAmB2B,OAApG,CAAjB;;aAEK3B,aAAL,CAAmB4B,OAAnB,IAA8B,KAAK5B,aAAL,CAAmB4B,OAAnB,CAA2B,KAAKJ,SAAhC,CAA9B;;;;;;;;;;gBAUQ,KAAKA,SAAb;KAxEc;;eA2EP3F,GAAX,EAAgBgG,SAAhB,EAA0B;YAClBtC,MAAMuC,QAAN,CAAejG,GAAf,KAAwB0D,MAAME,QAAN,CAAe5D,GAAf,KAAuB0D,MAAMwC,IAAN,CAAWlG,GAAX,CAAnD,EAAoE;mBACzD0D,MAAMuC,QAAN,CAAejG,GAAf,IAAsBA,GAAtB,GAA4BmG,SAASnG,IAAIF,IAAJ,GAAWsG,KAAX,CAAiB,CAAjB,EAAoB,CAAC,CAArB,CAAT,CAAnC;SADJ,MAGK,IAAI1C,MAAME,QAAN,CAAe5D,GAAf,KAAuB0D,MAAM2C,SAAN,CAAgBrG,GAAhB,CAA3B,EAAgD;mBAC1CgG,cAAc,GAAd,GAAoB,KAAKd,WAAL,CAAiBP,KAAjB,IAA0BwB,SAASnG,IAAIoG,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,CAAT,IAA6B,GAAvD,CAApB,GAAmF,KAAKlB,WAAL,CAAiBL,MAAjB,IAA2BsB,SAASnG,IAAIoG,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,CAAT,IAA6B,GAAxD,CAA1F;SADC,MAGA,IAAI1C,MAAME,QAAN,CAAe5D,GAAf,KAAuB0D,MAAM4C,QAAN,CAAetG,GAAf,CAA3B,EAA+C;mBACzCgG,cAAc,GAAd,GAAoB,KAAKd,WAAL,CAAiBP,KAAjB,GAAyB,CAA7C,GAAiD,KAAKO,WAAL,CAAiBL,MAAjB,GAA0B,CAAlF;SADC,MAGA,IAAInB,MAAME,QAAN,CAAe5D,GAAf,MAAwB0D,MAAM6C,MAAN,CAAavG,GAAb,KAAqB0D,MAAM8C,KAAN,CAAYxG,GAAZ,CAA7C,CAAJ,EAAmE;mBAC7D,CAAP;SADC,MAGA,IAAI0D,MAAME,QAAN,CAAe5D,GAAf,MAAwB0D,MAAM+C,OAAN,CAAczG,GAAd,KAAsB0D,MAAMgD,QAAN,CAAe1G,GAAf,CAA9C,CAAJ,EAAuE;mBACjE0D,MAAM+C,OAAN,CAAczG,GAAd,IAAqB,KAAKkF,WAAL,CAAiBP,KAAtC,GAA8C,KAAKO,WAAL,CAAiBL,MAAtE;SADC,MAGA;iBACIpB,QAAL,CAAckD,GAAd,GAAoB,QAApB;iBACKxC,aAAL,CAAmBqB,KAAnB,IAA4B,KAAKrB,aAAL,CAAmBqB,KAAnB,CAAyB,KAAK/B,QAA9B,CAA5B;mBACO,KAAP;;KA9FU;eAiGPzD,GAAX,EAAe;eACJ0D,MAAMkD,KAAN,CAAY5G,GAAZ,IAAmB,MAAnB,GAA4B,KAAnC;;CAlGR;;;;;;;;"}